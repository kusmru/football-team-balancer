<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Team Balancer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .player-list, .team-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .player-card {
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
            position: relative;
        }
        .player-card.selected {
            background-color: #e0e0e0;
        }
        .player-card.goalkeeper {
            background-color: #ffecb3;
        }
        .team {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            flex: 1;
            min-width: 200px;
            background-color: #f5f5f5;
        }
        .team-a {
            background-color: #e3f2fd;
        }
        .team-b {
            background-color: #ffebee;
        }
        .controls {
            margin: 20px 0;
        }
        button {
            padding: 8px 15px;
            margin-right: 10px;
            cursor: pointer;
        }
        .form {
            margin-bottom: 20px;
        }
        .form div {
            margin-bottom: 10px;
        }
        .stats {
            margin-top: 10px;
            font-weight: bold;
        }
        .delete-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            cursor: pointer;
            color: red;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>Football Team Balancer</h1>
    
    <div class="form">
        <h2>Add Player</h2>
        <div>
            <label for="playerName">Name:</label>
            <input type="text" id="playerName">
        </div>
        <div>
            <label for="playerRating">Skill Rating (1-10):</label>
            <input type="number" id="playerRating" min="1" max="10" value="5">
        </div>
        <div>
            <label for="isGoalkeeper">
                <input type="checkbox" id="isGoalkeeper">
                Can play as goalkeeper
            </label>
        </div>
        <button id="addPlayer">Add Player</button>
    </div>

    <h2>Available Players</h2>
    <div class="player-list" id="playerList"></div>
    
    <div class="controls">
        <button id="selectAttendees">Select Who's Playing Today</button>
        <button id="clearSelection">Clear Selection</button>
        <button id="balanceTeams">Balance Teams</button>
        <button id="resetTeams">Reset Teams</button>
    </div>
    
    <h2>Teams</h2>
    <div class="team-container">
        <div class="team team-a" id="teamA">
            <h3>Team A</h3>
            <div id="teamAPlayers"></div>
            <div class="stats" id="teamAStats"></div>
        </div>
        <div class="team team-b" id="teamB">
            <h3>Team B</h3>
            <div id="teamBPlayers"></div>
            <div class="stats" id="teamBStats"></div>
        </div>
    </div>

    <script>
        // Player database
        let allPlayers = JSON.parse(localStorage.getItem('footballPlayers')) || [];
        let selectedPlayers = [];
        let teamA = [];
        let teamB = [];
        
        // DOM elements
        const playerListEl = document.getElementById('playerList');
        const teamAPlayersEl = document.getElementById('teamAPlayers');
        const teamBPlayersEl = document.getElementById('teamBPlayers');
        const teamAStatsEl = document.getElementById('teamAStats');
        const teamBStatsEl = document.getElementById('teamBStats');
        
        // Initialize
        renderPlayerList();
        
        // Event Listeners
        document.getElementById('addPlayer').addEventListener('click', addPlayer);
        document.getElementById('selectAttendees').addEventListener('click', toggleSelectMode);
        document.getElementById('clearSelection').addEventListener('click', clearSelection);
        document.getElementById('balanceTeams').addEventListener('click', balanceTeams);
        document.getElementById('resetTeams').addEventListener('click', resetTeams);
        
        // Functions
        function addPlayer() {
            const name = document.getElementById('playerName').value.trim();
            const rating = parseInt(document.getElementById('playerRating').value);
            const isGoalkeeper = document.getElementById('isGoalkeeper').checked;
            
            if (!name) return alert('Please enter a player name');
            
            const player = {
                id: Date.now(),
                name: name,
                rating: rating,
                isGoalkeeper: isGoalkeeper
            };
            
            allPlayers.push(player);
            savePlayersToStorage();
            renderPlayerList();
            
            // Clear form
            document.getElementById('playerName').value = '';
            document.getElementById('playerRating').value = 5;
            document.getElementById('isGoalkeeper').checked = false;
        }
        
        function renderPlayerList() {
            playerListEl.innerHTML = '';
            
            allPlayers.forEach(player => {
                const playerCard = document.createElement('div');
                playerCard.className = `player-card${player.isGoalkeeper ? ' goalkeeper' : ''}${selectedPlayers.some(p => p.id === player.id) ? ' selected' : ''}`;
                playerCard.innerHTML = `
                    <span class="delete-btn" data-id="${player.id}">Ã—</span>
                    <strong>${player.name}</strong> 
                    <br>Rating: ${player.rating}/10
                    ${player.isGoalkeeper ? '<br><em>Goalkeeper</em>' : ''}
                `;
                
                playerCard.addEventListener('click', () => togglePlayerSelection(player));
                playerListEl.appendChild(playerCard);
                
                // Delete button
                const deleteBtn = playerCard.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deletePlayer(player.id);
                });
            });
        }
        
        function togglePlayerSelection(player) {
            const index = selectedPlayers.findIndex(p => p.id === player.id);
            
            if (index === -1) {
                selectedPlayers.push(player);
            } else {
                selectedPlayers.splice(index, 1);
            }
            
            renderPlayerList();
        }
        
        function deletePlayer(id) {
            if (confirm('Are you sure you want to delete this player?')) {
                allPlayers = allPlayers.filter(p => p.id !== id);
                selectedPlayers = selectedPlayers.filter(p => p.id !== id);
                savePlayersToStorage();
                renderPlayerList();
                renderTeams();
            }
        }
        
        function toggleSelectMode() {
            alert('Click on players to select who is playing today, then press "Balance Teams"');
        }
        
        function clearSelection() {
            selectedPlayers = [];
            renderPlayerList();
        }
        
        function balanceTeams() {
            if (selectedPlayers.length < 2) {
                return alert('Please select at least 2 players');
            }
            
            // Reset teams
            teamA = [];
            teamB = [];
            
            // Sort by rating, highest first
            const sortedPlayers = [...selectedPlayers].sort((a, b) => b.rating - a.rating);
            
            // Separate goalkeepers
            const goalkeepers = sortedPlayers.filter(p => p.isGoalkeeper);
            const fieldPlayers = sortedPlayers.filter(p => !p.isGoalkeeper);
            
            // Assign goalkeepers first, one to each team if available
            if (goalkeepers.length >= 2) {
                teamA.push(goalkeepers[0]);
                teamB.push(goalkeepers[1]);
                // Any extra goalkeepers will be treated as field players
                for (let i = 2; i < goalkeepers.length; i++) {
                    fieldPlayers.push(goalkeepers[i]);
                }
            } else if (goalkeepers.length === 1) {
                teamA.push(goalkeepers[0]);
            }
            
            // Sort field players again
            fieldPlayers.sort((a, b) => b.rating - a.rating);
            
            // Distribute field players using alternating selection
            let teamATotal = getTotalRating(teamA);
            let teamBTotal = getTotalRating(teamB);
            
            for (const player of fieldPlayers) {
                if (teamATotal <= teamBTotal) {
                    teamA.push(player);
                    teamATotal += player.rating;
                } else {
                    teamB.push(player);
                    teamBTotal += player.rating;
                }
            }
            
            renderTeams();
        }
        
        function renderTeams() {
            renderTeam(teamA, teamAPlayersEl, teamAStatsEl);
            renderTeam(teamB, teamBPlayersEl, teamBStatsEl);
        }
        
        function renderTeam(team, container, statsContainer) {
            container.innerHTML = '';
            
            if (team.length === 0) {
                container.innerHTML = '<p>No players assigned</p>';
                statsContainer.innerHTML = '';
                return;
            }
            
            team.forEach(player => {
                const playerEl = document.createElement('div');
                playerEl.className = player.isGoalkeeper ? 'player-card goalkeeper' : 'player-card';
                playerEl.innerHTML = `
                    <strong>${player.name}</strong> 
                    <br>Rating: ${player.rating}/10
                    ${player.isGoalkeeper ? '<br><em>Goalkeeper</em>' : ''}
                `;
                container.appendChild(playerEl);
            });
            
            // Update stats
            const totalRating = getTotalRating(team);
            const avgRating = totalRating / team.length;
            statsContainer.innerHTML = `
                Players: ${team.length} | 
                Total Rating: ${totalRating} | 
                Avg Rating: ${avgRating.toFixed(1)}
            `;
        }
        
        function getTotalRating(team) {
            return team.reduce((sum, player) => sum + player.rating, 0);
        }
        
        function resetTeams() {
            teamA = [];
            teamB = [];
            renderTeams();
        }
        
        function savePlayersToStorage() {
            localStorage.setItem('footballPlayers', JSON.stringify(allPlayers));
        }
    </script>
</body>
</html>
